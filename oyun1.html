<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Güç Reaktörü - Üslü Sayılar</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #121212;
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }

        /* Arkaplan Animasyonu */
        .bg-grid {
            position: absolute;
            width: 200%;
            height: 200%;
            background: linear-gradient(0deg, transparent 24%, rgba(0, 255, 255, .05) 25%, rgba(0, 255, 255, .05) 26%, transparent 27%, transparent 74%, rgba(0, 255, 255, .05) 75%, rgba(0, 255, 255, .05) 76%, transparent 77%, transparent), linear-gradient(90deg, transparent 24%, rgba(0, 255, 255, .05) 25%, rgba(0, 255, 255, .05) 26%, transparent 27%, transparent 74%, rgba(0, 255, 255, .05) 75%, rgba(0, 255, 255, .05) 76%, transparent 77%, transparent);
            background-size: 50px 50px;
            transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
            animation: gridMove 20s linear infinite;
            z-index: -1;
        }

        @keyframes gridMove {
            0% {
                transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px);
            }

            100% {
                transform: perspective(500px) rotateX(60deg) translateY(50px) translateZ(-200px);
            }
        }

        /* Üst Panel */
        .hud-top {
            width: 90%;
            display: flex;
            justify-content: space-between;
            padding: 20px;
            z-index: 10;
        }

        .hud-btn {
            background: rgba(0, 210, 211, 0.1);
            border: 1px solid #00d2d3;
            color: #00d2d3;
            padding: 10px 20px;
            cursor: pointer;
            text-decoration: none;
            font-family: 'Orbitron';
            transition: 0.3s;
        }

        .hud-btn:hover {
            background: #00d2d3;
            color: #000;
        }

        /* REAKTÖR ALANI */
        .reactor-container {
            position: relative;
            width: 300px;
            height: 300px;
            margin-top: 20px;
            border-radius: 50%;
            border: 10px solid #333;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle, #222 0%, #000 100%);
        }

        .core {
            width: 150px;
            height: 150px;
            background: #ff4757;
            border-radius: 50%;
            box-shadow: 0 0 20px #ff4757;
            transition: all 0.5s;
            animation: pulse 2s infinite;
        }

        .core.stable {
            background: #00d2d3;
            box-shadow: 0 0 30px #00d2d3;
            animation: pulseStable 3s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.95);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.05);
                opacity: 1;
            }

            100% {
                transform: scale(0.95);
                opacity: 0.8;
            }
        }

        @keyframes pulseStable {
            0% {
                transform: scale(0.98);
                opacity: 0.9;
            }

            50% {
                transform: scale(1.02);
                opacity: 1;
            }

            100% {
                transform: scale(0.98);
                opacity: 0.9;
            }
        }

        /* Soru Alanı */
        .question-panel {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00d2d3;
            padding: 20px 40px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            position: relative;
            min-width: 300px;
        }

        .math-expr {
            font-size: 3rem;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .sup {
            font-size: 1.5rem;
            vertical-align: super;
            color: #ff9f43;
        }

        .visual-hint {
            margin-top: 15px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        /* Kare Görseli */
        .grid-visual {
            display: grid;
            gap: 2px;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px;
            border-radius: 4px;
        }

        .cell {
            width: 15px;
            height: 15px;
            background: #00d2d3;
            border-radius: 2px;
        }

        /* Küp Görseli (Basit 2.5D) */
        .cube-visual {
            position: relative;
            width: 60px;
            height: 60px;
            transform-style: preserve-3d;
            transform: rotateX(-20deg) rotateY(45deg);
        }

        .cube-layer {
            position: absolute;
            width: 100%;
            height: 100%;
            display: grid;
            gap: 2px;
        }

        /* Cevap Butonları */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
            width: 100%;
            max-width: 500px;
        }

        .opt-btn {
            background: #2d3436;
            border: 2px solid #636e72;
            color: #fff;
            padding: 15px;
            font-size: 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Orbitron';
            transition: 0.2s;
        }

        .opt-btn:hover {
            background: #636e72;
            transform: translateY(-3px);
        }

        .opt-btn.correct {
            background: #00b894;
            border-color: #00b894;
        }

        .opt-btn.wrong {
            background: #d63031;
            border-color: #d63031;
        }

        /* İlerleme Çubuğu */
        .progress-container {
            width: 60%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin-top: 30px;
            overflow: hidden;
            border: 1px solid #555;
        }

        .progress-bar {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #ff9f43, #ee5253);
            transition: width 0.5s;
        }

        /* Mesaj */
        .message-box {
            height: 30px;
            margin-top: 10px;
            color: #fab1a0;
            font-size: 1.1rem;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .modal-content {
            background: #111;
            border: 2px solid #00d2d3;
            padding: 40px;
            text-align: center;
            border-radius: 10px;
            box-shadow: 0 0 50px rgba(0, 210, 211, 0.3);
        }

        .next-btn {
            background: #00d2d3;
            color: #000;
            padding: 15px 30px;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <div class="bg-grid"></div>

    <div class="hud-top">
        <a href="index.html" class="hud-btn">❮ ANA MENÜ</a>
        <div style="font-size:1.2rem; color:#00d2d3;">GÖREV: GÜÇ REAKTÖRÜ</div>
    </div>

    <div class="reactor-container">
        <div class="core" id="reactor-core"></div>
        <div style="position: absolute; color: white; font-size: 2rem; font-weight: bold; text-shadow: 0 0 10px black;"
            id="power-text">0%</div>
    </div>

    <div class="progress-container">
        <div class="progress-bar" id="p-bar"></div>
    </div>

    <div class="question-panel">
        <div class="math-expr" id="q-expr"></div>
        <div class="visual-hint" id="v-hint"></div>
        <div class="message-box" id="msg-box"></div>
    </div>

    <div class="options-grid" id="opt-grid">
        <!-- Seçenekler buraya gelecek -->
    </div>

    <!-- Başarı Modalı -->
    <div class="modal" id="winModal">
        <div class="modal-content">
            <h1 style="color:#00d2d3;">REAKTÖR STABİL!</h1>
            <p style="font-size:1.2rem; color:#aaa;">Enerji seviyesi maksimuma ulaştı.</p>
            <div style="margin: 20px 0; border: 1px dashed #ff9f43; padding: 10px; color: #ff9f43;">
                ŞİFRE PARÇASI: <strong>İ</strong>
            </div>
            <button class="next-btn" onclick="window.location.href='index.html'">GÖREV TAMAMLANDI</button>
        </div>
    </div>

    <script>
        // Oyun Verileri
        const questions = [
            { base: 2, exp: 2 }, // 4
            { base: 3, exp: 2 }, // 9
            { base: 5, exp: 2 }, // 25
            { base: 2, exp: 3 }, // 8
            { base: 3, exp: 3 }, // 27
            { base: 4, exp: 2 }, // 16
            { base: 4, exp: 3 }, // 64
            { base: 6, exp: 2 }, // 36
            { base: 5, exp: 3 }, // 125
            { base: 10, exp: 2 } // 100
        ];

        let currentQ = 0;
        let powerLevel = 0;
        const totalLevels = 6; // Kaç doğru cevapta bitsin
        let isLocked = false;

        function startGame() {
            currentQ = 0;
            powerLevel = 0;
            updatePower(0);
            askQuestion();
        }

        function updatePower(val) {
            powerLevel = val;
            let percent = (val / totalLevels) * 100;
            if (percent > 100) percent = 100;

            document.getElementById('p-bar').style.width = percent + "%";
            document.getElementById('power-text').innerText = Math.floor(percent) + "%";

            // Reaktör Rengi
            const core = document.getElementById('reactor-core');
            if (percent >= 100) {
                core.classList.add('stable');
                document.getElementById('p-bar').style.background = '#00d2d3';
            } else {
                core.classList.remove('stable');
            }
        }

        function askQuestion() {
            if (powerLevel >= totalLevels) {
                setTimeout(() => { document.getElementById('winModal').style.display = 'flex'; }, 500);
                return;
            }

            const q = questions[Math.floor(Math.random() * questions.length)];
            const correctAns = Math.pow(q.base, q.exp);

            // Soruyu Göster
            document.getElementById('q-expr').innerHTML = `${q.base}<span class="sup">${q.exp}</span> = ?`;

            // Görsel İpucu
            const hintContainer = document.getElementById('v-hint');
            hintContainer.innerHTML = "";

            if (q.exp === 2) {
                // Kare ızgarası: base x base
                hintContainer.innerHTML = `<div style="display:grid; grid-template-columns:repeat(${q.base}, 1fr); gap:2px; width:${q.base * 10 + 10}px;">
                    ${Array(q.base * q.base).fill('<div style="width:10px; height:10px; background:#00d2d3;"></div>').join('')}
                </div>`;
            } else {
                // Küp (basit temsili) -> base tane kare katmanı (aslında karmaşık ama basit tutacağız)
                // Sadece metin ipucu verelim şimdilik, CSS 3D küp karmaşık olabilir
                hintContainer.innerHTML = `<span style="font-size:0.9rem; color:#aaa;">${q.base} x ${q.base} x ${q.base}</span>`;
            }

            // Seçenekleri Üret
            let opts = [correctAns];
            while (opts.length < 3) {
                let offset = Math.floor(Math.random() * 20) - 10;
                let wrong = correctAns + offset;
                if (wrong > 0 && !opts.includes(wrong)) opts.push(wrong);
            }
            // Karıştır
            opts.sort(() => Math.random() - 0.5);

            const optGrid = document.getElementById('opt-grid');
            optGrid.innerHTML = "";
            opts.forEach(val => {
                const btn = document.createElement('button');
                btn.className = 'opt-btn';
                btn.innerText = val;
                btn.onclick = () => handleAnswer(btn, val, correctAns);
                optGrid.appendChild(btn);
            });

            document.getElementById('msg-box').innerText = "";
            isLocked = false;
        }

        function handleAnswer(btn, val, correct) {
            if (isLocked) return;
            isLocked = true;

            if (val === correct) {
                btn.classList.add('correct');
                document.getElementById('msg-box').innerText = "ENERJİ KABUL EDİLDİ!";
                document.getElementById('msg-box').style.color = "#00d2d3";
                updatePower(powerLevel + 1);
                setTimeout(askQuestion, 1000);
            } else {
                btn.classList.add('wrong');
                document.getElementById('msg-box').innerText = "DENGESİZ GÜÇ! TEKRAR DENE.";
                document.getElementById('msg-box').style.color = "#ff4757";
                isLocked = false; // Tekrar denemeye izin ver
            }
        }

        window.onload = startGame;

    </script>
</body>

</html>